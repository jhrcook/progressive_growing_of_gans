Initializing TensorFlow...
Running train.train_progressive_gan()...
Streaming data using dataset.TFRecordDataset...
Dataset shape = [1, 1024, 1024]
Dynamic range = [0, 255]
Label size    = 0
Constructing networks...

G                           Params      OutputShape             WeightShape
---                         ---         ---                     ---
latents_in                  -           (?, 20)                 -
labels_in                   -           (?, 0)                  -
lod                         -           ()                      -
4x4/PixelNorm               -           (?, 20)                 -
4x4/Dense                   164352      (?, 512, 4, 4)          (20, 8192)
4x4/Conv                    2359808     (?, 512, 4, 4)          (3, 3, 512, 512)
ToRGB_lod8                  513         (?, 1, 4, 4)            (1, 1, 512, 1)
8x8/Conv0_up                2359808     (?, 512, 8, 8)          (3, 3, 512, 512)
8x8/Conv1                   2359808     (?, 512, 8, 8)          (3, 3, 512, 512)
ToRGB_lod7                  513         (?, 1, 8, 8)            (1, 1, 512, 1)
Upscale2D                   -           (?, 1, 8, 8)            -
Grow_lod7                   -           (?, 1, 8, 8)            -
16x16/Conv0_up              2359808     (?, 512, 16, 16)        (3, 3, 512, 512)
16x16/Conv1                 2359808     (?, 512, 16, 16)        (3, 3, 512, 512)
ToRGB_lod6                  513         (?, 1, 16, 16)          (1, 1, 512, 1)
Upscale2D_1                 -           (?, 1, 16, 16)          -
Grow_lod6                   -           (?, 1, 16, 16)          -
32x32/Conv0_up              2359808     (?, 512, 32, 32)        (3, 3, 512, 512)
32x32/Conv1                 2359808     (?, 512, 32, 32)        (3, 3, 512, 512)
ToRGB_lod5                  513         (?, 1, 32, 32)          (1, 1, 512, 1)
Upscale2D_2                 -           (?, 1, 32, 32)          -
Grow_lod5                   -           (?, 1, 32, 32)          -
64x64/Conv0_up              1179904     (?, 256, 64, 64)        (3, 3, 256, 512)
64x64/Conv1                 590080      (?, 256, 64, 64)        (3, 3, 256, 256)
ToRGB_lod4                  257         (?, 1, 64, 64)          (1, 1, 256, 1)
Upscale2D_3                 -           (?, 1, 64, 64)          -
Grow_lod4                   -           (?, 1, 64, 64)          -
128x128/Conv0_up            295040      (?, 128, 128, 128)      (3, 3, 128, 256)
128x128/Conv1               147584      (?, 128, 128, 128)      (3, 3, 128, 128)
ToRGB_lod3                  129         (?, 1, 128, 128)        (1, 1, 128, 1)
Upscale2D_4                 -           (?, 1, 128, 128)        -
Grow_lod3                   -           (?, 1, 128, 128)        -
256x256/Conv0_up            73792       (?, 64, 256, 256)       (3, 3, 64, 128)
256x256/Conv1               36928       (?, 64, 256, 256)       (3, 3, 64, 64)
ToRGB_lod2                  65          (?, 1, 256, 256)        (1, 1, 64, 1)
Upscale2D_5                 -           (?, 1, 256, 256)        -
Grow_lod2                   -           (?, 1, 256, 256)        -
512x512/Conv0_up            18464       (?, 32, 512, 512)       (3, 3, 32, 64)
512x512/Conv1               9248        (?, 32, 512, 512)       (3, 3, 32, 32)
ToRGB_lod1                  33          (?, 1, 512, 512)        (1, 1, 32, 1)
Upscale2D_6                 -           (?, 1, 512, 512)        -
Grow_lod1                   -           (?, 1, 512, 512)        -
1024x1024/Conv0_up          4624        (?, 16, 1024, 1024)     (3, 3, 16, 32)
1024x1024/Conv1             2320        (?, 16, 1024, 1024)     (3, 3, 16, 16)
ToRGB_lod0                  17          (?, 1, 1024, 1024)      (1, 1, 16, 1)
Upscale2D_7                 -           (?, 1, 1024, 1024)      -
Grow_lod0                   -           (?, 1, 1024, 1024)      -
images_out                  -           (?, 1, 1024, 1024)      -
---                         ---         ---                     ---
Total                       19043545


D                           Params      OutputShape             WeightShape
---                         ---         ---                     ---
images_in                   -           (?, 1, 1024, 1024)      -
lod                         -           ()                      -
FromRGB_lod0                32          (?, 16, 1024, 1024)     (1, 1, 1, 16)
1024x1024/Conv0             2320        (?, 16, 1024, 1024)     (3, 3, 16, 16)
1024x1024/Conv1_down        4640        (?, 32, 512, 512)       (3, 3, 16, 32)
Downscale2D                 -           (?, 1, 512, 512)        -
FromRGB_lod1                64          (?, 32, 512, 512)       (1, 1, 1, 32)
Grow_lod0                   -           (?, 32, 512, 512)       -
512x512/Conv0               9248        (?, 32, 512, 512)       (3, 3, 32, 32)
512x512/Conv1_down          18496       (?, 64, 256, 256)       (3, 3, 32, 64)
Downscale2D_1               -           (?, 1, 256, 256)        -
FromRGB_lod2                128         (?, 64, 256, 256)       (1, 1, 1, 64)
Grow_lod1                   -           (?, 64, 256, 256)       -
256x256/Conv0               36928       (?, 64, 256, 256)       (3, 3, 64, 64)
256x256/Conv1_down          73856       (?, 128, 128, 128)      (3, 3, 64, 128)
Downscale2D_2               -           (?, 1, 128, 128)        -
FromRGB_lod3                256         (?, 128, 128, 128)      (1, 1, 1, 128)
Grow_lod2                   -           (?, 128, 128, 128)      -
128x128/Conv0               147584      (?, 128, 128, 128)      (3, 3, 128, 128)
128x128/Conv1_down          295168      (?, 256, 64, 64)        (3, 3, 128, 256)
Downscale2D_3               -           (?, 1, 64, 64)          -
FromRGB_lod4                512         (?, 256, 64, 64)        (1, 1, 1, 256)
Grow_lod3                   -           (?, 256, 64, 64)        -
64x64/Conv0                 590080      (?, 256, 64, 64)        (3, 3, 256, 256)
64x64/Conv1_down            1180160     (?, 512, 32, 32)        (3, 3, 256, 512)
Downscale2D_4               -           (?, 1, 32, 32)          -
FromRGB_lod5                1024        (?, 512, 32, 32)        (1, 1, 1, 512)
Grow_lod4                   -           (?, 512, 32, 32)        -
32x32/Conv0                 2359808     (?, 512, 32, 32)        (3, 3, 512, 512)
32x32/Conv1_down            2359808     (?, 512, 16, 16)        (3, 3, 512, 512)
Downscale2D_5               -           (?, 1, 16, 16)          -
FromRGB_lod6                1024        (?, 512, 16, 16)        (1, 1, 1, 512)
Grow_lod5                   -           (?, 512, 16, 16)        -
16x16/Conv0                 2359808     (?, 512, 16, 16)        (3, 3, 512, 512)
16x16/Conv1_down            2359808     (?, 512, 8, 8)          (3, 3, 512, 512)
Downscale2D_6               -           (?, 1, 8, 8)            -
FromRGB_lod7                1024        (?, 512, 8, 8)          (1, 1, 1, 512)
Grow_lod6                   -           (?, 512, 8, 8)          -
8x8/Conv0                   2359808     (?, 512, 8, 8)          (3, 3, 512, 512)
8x8/Conv1_down              2359808     (?, 512, 4, 4)          (3, 3, 512, 512)
Downscale2D_7               -           (?, 1, 4, 4)            -
FromRGB_lod8                1024        (?, 512, 4, 4)          (1, 1, 1, 512)
Grow_lod7                   -           (?, 512, 4, 4)          -
4x4/MinibatchStddev         -           (?, 1, 4, 4)            -
4x4/Conv                    2364416     (?, 512, 4, 4)          (3, 3, 513, 512)
4x4/Dense0                  4194816     (?, 512)                (8192, 512)
4x4/Dense1                  513         (?, 1)                  (512, 1)
scores_out                  -           (?, 1)                  -
labels_out                  -           (?, 0)                  -
---                         ---         ---                     ---
Total                       23082161

Building TensorFlow graph...
Setting up snapshot image grid...
Setting up result dir...
Saving results to results/009-pgan-hand-radiographs-preset-v2-4gpus-fp16-HIST
Training...
tick 1     kimg 161.8    lod 8.00  minibatch 512  time 3m 00s       sec/tick 179.6   sec/kimg 1.11    maintenance 121.8
tick 2     kimg 323.6    lod 8.00  minibatch 512  time 5m 39s       sec/tick 132.2   sec/kimg 0.82    maintenance 27.6
tick 3     kimg 485.4    lod 8.00  minibatch 512  time 7m 53s       sec/tick 131.6   sec/kimg 0.81    maintenance 1.9
tick 4     kimg 625.7    lod 7.96  minibatch 256  time 10m 25s      sec/tick 151.0   sec/kimg 1.08    maintenance 1.4
tick 5     kimg 766.0    lod 7.73  minibatch 256  time 14m 29s      sec/tick 241.7   sec/kimg 1.72    maintenance 2.2
tick 6     kimg 906.2    lod 7.49  minibatch 256  time 18m 31s      sec/tick 240.3   sec/kimg 1.71    maintenance 1.4
tick 7     kimg 1046.5   lod 7.26  minibatch 256  time 22m 36s      sec/tick 243.4   sec/kimg 1.74    maintenance 1.5
tick 8     kimg 1186.8   lod 7.02  minibatch 256  time 26m 38s      sec/tick 240.8   sec/kimg 1.72    maintenance 1.4
tick 9     kimg 1327.1   lod 7.00  minibatch 256  time 30m 36s      sec/tick 236.5   sec/kimg 1.69    maintenance 1.4
tick 10    kimg 1467.4   lod 7.00  minibatch 256  time 34m 34s      sec/tick 236.5   sec/kimg 1.69    maintenance 1.7
tick 11    kimg 1607.7   lod 7.00  minibatch 256  time 38m 36s      sec/tick 236.1   sec/kimg 1.68    maintenance 5.5
tick 12    kimg 1748.0   lod 7.00  minibatch 256  time 42m 37s      sec/tick 239.2   sec/kimg 1.71    maintenance 1.7
tick 13    kimg 1868.3   lod 6.89  minibatch 128  time 48m 38s      sec/tick 359.8   sec/kimg 2.99    maintenance 1.5
tick 14    kimg 1988.6   lod 6.69  minibatch 128  time 56m 12s      sec/tick 452.2   sec/kimg 3.76    maintenance 1.8
tick 15    kimg 2108.9   lod 6.49  minibatch 128  time 1h 03m 45s   sec/tick 451.4   sec/kimg 3.75    maintenance 1.6
tick 16    kimg 2229.2   lod 6.29  minibatch 128  time 1h 11m 23s   sec/tick 456.5   sec/kimg 3.79    maintenance 1.6
tick 17    kimg 2349.6   lod 6.08  minibatch 128  time 1h 18m 55s   sec/tick 450.0   sec/kimg 3.74    maintenance 1.6
tick 18    kimg 2469.9   lod 6.00  minibatch 128  time 1h 26m 25s   sec/tick 449.2   sec/kimg 3.73    maintenance 1.4
tick 19    kimg 2590.2   lod 6.00  minibatch 128  time 1h 33m 55s   sec/tick 448.1   sec/kimg 3.72    maintenance 1.5
tick 20    kimg 2710.5   lod 6.00  minibatch 128  time 1h 41m 27s   sec/tick 450.1   sec/kimg 3.74    maintenance 1.8
tick 21    kimg 2830.8   lod 6.00  minibatch 128  time 1h 48m 24s   sec/tick 413.8   sec/kimg 3.44    maintenance 3.5
tick 22    kimg 2951.2   lod 6.00  minibatch 128  time 1h 55m 15s   sec/tick 410.2   sec/kimg 3.41    maintenance 1.3
tick 23    kimg 3051.3   lod 5.91  minibatch 64   time 2h 05m 37s   sec/tick 620.4   sec/kimg 6.20    maintenance 1.4
tick 24    kimg 3151.4   lod 5.75  minibatch 64   time 2h 19m 06s   sec/tick 806.5   sec/kimg 8.06    maintenance 1.9
tick 25    kimg 3251.5   lod 5.58  minibatch 64   time 2h 32m 01s   sec/tick 773.4   sec/kimg 7.73    maintenance 1.4
tick 26    kimg 3351.6   lod 5.41  minibatch 64   time 2h 45m 01s   sec/tick 779.3   sec/kimg 7.79    maintenance 1.5
tick 27    kimg 3451.6   lod 5.25  minibatch 64   time 2h 57m 57s   sec/tick 774.2   sec/kimg 7.73    maintenance 1.4
tick 28    kimg 3551.7   lod 5.08  minibatch 64   time 3h 10m 53s   sec/tick 773.9   sec/kimg 7.73    maintenance 1.7
tick 29    kimg 3651.8   lod 5.00  minibatch 64   time 3h 23m 47s   sec/tick 773.0   sec/kimg 7.72    maintenance 1.5
tick 30    kimg 3751.9   lod 5.00  minibatch 64   time 3h 36m 38s   sec/tick 769.0   sec/kimg 7.68    maintenance 1.4
tick 31    kimg 3852.0   lod 5.00  minibatch 64   time 3h 49m 31s   sec/tick 770.7   sec/kimg 7.70    maintenance 3.1
tick 32    kimg 3952.1   lod 5.00  minibatch 64   time 4h 02m 25s   sec/tick 771.7   sec/kimg 7.71    maintenance 1.5
tick 33    kimg 4052.2   lod 5.00  minibatch 64   time 4h 15m 18s   sec/tick 771.8   sec/kimg 7.71    maintenance 1.5
tick 34    kimg 4152.3   lod 5.00  minibatch 64   time 4h 28m 08s   sec/tick 769.1   sec/kimg 7.68    maintenance 1.4
tick 35    kimg 4232.3   lod 4.95  minibatch 32   time 4h 44m 16s   sec/tick 965.8   sec/kimg 12.07   maintenance 1.4
tick 36    kimg 4312.3   lod 4.81  minibatch 32   time 5h 07m 24s   sec/tick 1386.7  sec/kimg 17.33   maintenance 1.7
tick 37    kimg 4392.3   lod 4.68  minibatch 32   time 5h 30m 26s   sec/tick 1380.4  sec/kimg 17.26   maintenance 1.4
tick 38    kimg 4472.3   lod 4.55  minibatch 32   time 5h 53m 19s   sec/tick 1372.1  sec/kimg 17.15   maintenance 1.4
tick 39    kimg 4552.3   lod 4.41  minibatch 32   time 6h 16m 21s   sec/tick 1379.7  sec/kimg 17.25   maintenance 1.5
tick 40    kimg 4632.3   lod 4.28  minibatch 32   time 6h 39m 15s   sec/tick 1373.4  sec/kimg 17.17   maintenance 1.4
tick 41    kimg 4712.3   lod 4.15  minibatch 32   time 7h 02m 20s   sec/tick 1381.3  sec/kimg 17.27   maintenance 3.3
tick 42    kimg 4792.3   lod 4.01  minibatch 32   time 7h 25m 22s   sec/tick 1380.5  sec/kimg 17.26   maintenance 1.4
tick 43    kimg 4872.3   lod 4.00  minibatch 32   time 7h 48m 13s   sec/tick 1370.1  sec/kimg 17.13   maintenance 1.5
tick 44    kimg 4952.3   lod 4.00  minibatch 32   time 8h 11m 04s   sec/tick 1368.9  sec/kimg 17.11   maintenance 1.4
tick 45    kimg 5032.3   lod 4.00  minibatch 32   time 8h 33m 48s   sec/tick 1363.0  sec/kimg 17.04   maintenance 1.4
tick 46    kimg 5112.3   lod 4.00  minibatch 32   time 8h 56m 39s   sec/tick 1369.6  sec/kimg 17.12   maintenance 1.4
tick 47    kimg 5192.3   lod 4.00  minibatch 32   time 9h 19m 28s   sec/tick 1367.5  sec/kimg 17.09   maintenance 1.5
tick 48    kimg 5272.3   lod 4.00  minibatch 32   time 9h 42m 17s   sec/tick 1367.0  sec/kimg 17.09   maintenance 1.5
tick 49    kimg 5352.3   lod 4.00  minibatch 32   time 10h 05m 04s  sec/tick 1365.4  sec/kimg 17.07   maintenance 1.4
tick 50    kimg 5412.4   lod 3.98  minibatch 16   time 10h 26m 28s  sec/tick 1282.7  sec/kimg 21.37   maintenance 1.3
tick 51    kimg 5472.4   lod 3.88  minibatch 16   time 11h 02m 35s  sec/tick 2163.5  sec/kimg 36.04   maintenance 3.7
tick 52    kimg 5532.4   lod 3.78  minibatch 16   time 11h 38m 32s  sec/tick 2155.5  sec/kimg 35.91   maintenance 1.4
tick 53    kimg 5592.4   lod 3.68  minibatch 16   time 12h 14m 36s  sec/tick 2162.7  sec/kimg 36.03   maintenance 1.4
tick 54    kimg 5652.5   lod 3.58  minibatch 16   time 12h 50m 36s  sec/tick 2158.6  sec/kimg 35.96   maintenance 1.4
tick 55    kimg 5712.5   lod 3.48  minibatch 16   time 13h 26m 38s  sec/tick 2160.3  sec/kimg 35.99   maintenance 1.6
tick 56    kimg 5772.5   lod 3.38  minibatch 16   time 14h 02m 45s  sec/tick 2165.3  sec/kimg 36.07   maintenance 1.4
tick 57    kimg 5832.6   lod 3.28  minibatch 16   time 14h 38m 37s  sec/tick 2151.0  sec/kimg 35.83   maintenance 1.4
tick 58    kimg 5892.6   lod 3.18  minibatch 16   time 15h 14m 18s  sec/tick 2139.8  sec/kimg 35.64   maintenance 1.3
tick 59    kimg 5952.6   lod 3.08  minibatch 16   time 15h 50m 03s  sec/tick 2144.1  sec/kimg 35.72   maintenance 1.4
tick 60    kimg 6012.7   lod 3.00  minibatch 16   time 16h 25m 51s  sec/tick 2146.5  sec/kimg 35.76   maintenance 1.4
tick 61    kimg 6072.7   lod 3.00  minibatch 16   time 17h 01m 25s  sec/tick 2130.1  sec/kimg 35.48   maintenance 3.3
tick 62    kimg 6132.7   lod 3.00  minibatch 16   time 17h 37m 04s  sec/tick 2137.7  sec/kimg 35.61   maintenance 1.4
tick 63    kimg 6192.8   lod 3.00  minibatch 16   time 18h 12m 47s  sec/tick 2141.3  sec/kimg 35.67   maintenance 1.4
tick 64    kimg 6252.8   lod 3.00  minibatch 16   time 18h 48m 27s  sec/tick 2139.1  sec/kimg 35.63   maintenance 1.5
tick 65    kimg 6312.8   lod 3.00  minibatch 16   time 19h 24m 12s  sec/tick 2143.5  sec/kimg 35.71   maintenance 1.5
tick 66    kimg 6372.9   lod 3.00  minibatch 16   time 20h 00m 03s  sec/tick 2148.9  sec/kimg 35.80   maintenance 1.6
